<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Shooter 2D Guerra</title>

<style>
body {
    margin: 0;
    background: black;
    overflow: hidden;
    font-family: Arial, sans-serif;
}

canvas {
    display: block;
    margin: auto;
    background: black;
    border: 3px solid white;
}

#hud {
    position: absolute;
    top: 10px;
    left: 10px;
    color: white;
    font-size: 18px;
}
</style>
</head>

<body>

<div id="hud">Puntos: <span id="score">0</span></div>
<canvas id="game" width="900" height="400"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// ===== IMÃGENES =====
const playerImg = new Image();
playerImg.src = "tank.png";

const soldierImg = new Image();
soldierImg.src = "enemy1.png";

const enemyTankImg = new Image();
enemyTankImg.src = "enemyTank.png";

// ===== VARIABLES =====
let score = 0;
const keys = {};
let bullets = [];
let enemies = [];

// ===== JUGADOR =====
const player = {
    x: 60,
    y: 200,
    w: 80,
    h: 40,
    speed: 3
};

// ===== CONTROLES =====
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

// ===== DISPARO =====
function shoot() {
    bullets.push({
        x: player.x + player.w,
        y: player.y + player.h / 2 - 3,
        w: 12,
        h: 6,
        speed: 8
    });
}

// ===== CREAR ENEMIGOS =====
function spawnEnemy() {

    // posiciones para TANQUES
    const tankPositions = [
        20,                                   // arriba
        canvas.height / 2 - 25,              // medio
        canvas.height - 70                   // abajo
    ];

    if (Math.random() < 0.7) {
        // SOLDADO (2 disparos)
        enemies.push({
            type: "soldier",
            img: soldierImg,
            x: canvas.width,
            y: Math.random() * (canvas.height - 60),
            w: 40,
            h: 60,
            speed: 2,
            life: 2
        });
    } else {
        // TANQUE ENEMIGO (3 disparos)
        enemies.push({
            type: "tank",
            img: enemyTankImg,
            x: canvas.width,
            y: tankPositions[Math.floor(Math.random() * tankPositions.length)],
            w: 90,
            h: 45,
            speed: 1,
            life: 3
        });
    }
}

setInterval(spawnEnemy, 1200);

// ===== UPDATE =====
function update() {

    // Movimiento jugador
    if (keys["a"]) player.x -= player.speed;
    if (keys["d"]) player.x += player.speed;
    if (keys["w"]) player.y -= player.speed;
    if (keys["s"]) player.y += player.speed;

    player.x = Math.max(0, Math.min(player.x, canvas.width - player.w));
    player.y = Math.max(0, Math.min(player.y, canvas.height - player.h));

    // Disparo
    if (keys[" "] && bullets.length < 5) shoot();

    // Balas
    bullets.forEach((b, i) => {
        b.x += b.speed;
        if (b.x > canvas.width) bullets.splice(i, 1);
    });

    // Enemigos
    enemies.forEach((e, ei) => {
        e.x -= e.speed;

        // Bala vs enemigo
        bullets.forEach((b, bi) => {
            if (
                b.x < e.x + e.w &&
                b.x + b.w > e.x &&
                b.y < e.y + e.h &&
                b.y + b.h > e.y
            ) {
                bullets.splice(bi, 1);
                e.life--;

                if (e.life <= 0) {
                    enemies.splice(ei, 1);
                    score += (e.type === "tank" ? 30 : 10);
                    document.getElementById("score").textContent = score;
                }
            }
        });

        // ColisiÃ³n jugador
        if (
            player.x < e.x + e.w &&
            player.x + player.w > e.x &&
            player.y < e.y + e.h &&
            player.y + player.h > e.y
        ) {
            alert("ðŸ’¥ GAME OVER ðŸ’¥\nPuntos: " + score);
            location.reload();
        }
    });
}

// ===== DIBUJO =====
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Jugador
    ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);

    // Balas
    ctx.fillStyle = "yellow";
    bullets.forEach(b => ctx.fillRect(b.x, b.y, b.w, b.h));

    // Enemigos
    enemies.forEach(e => {
        ctx.drawImage(e.img, e.x, e.y, e.w, e.h);
    });
}

// ===== LOOP =====
function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

// Esperar imÃ¡genes
enemyTankImg.onload = () => loop();
</script>

</body>
</html>